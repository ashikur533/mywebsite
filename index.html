<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Daily Tour SMS Report</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f4f7;
}
.container{
    width:95%;
    margin:20px auto;
    background:#fff;
    padding:20px;
    box-shadow:0 0 10px #ccc;
}
textarea{
    width:100%;
    height:220px;
    padding:10px;
    font-size:14px;
}
button{
    padding:8px 14px;
    background:#0066cc;
    color:#fff;
    border:none;
    cursor:pointer;
    margin-right:5px;
}
button:hover{ background:#004999; }

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th,td{
    border:1px solid #aaa;
    padding:6px;
    font-size:13px;
}
th{ background:#e9eef3; }
td[contenteditable="true"]{ background:#fffbe6; }
</style>
</head>

<body>

<div class="container">
<h2>ðŸ“© Daily Tour Plan SMS â†’ Report</h2>

<textarea id="sms" placeholder="Paste Daily Tour SMS here..."></textarea><br><br>

<button onclick="addData()">âž• Add</button>
<button onclick="exportExcel()">ðŸ“Š Export Excel</button>

<table id="dataTable">
<thead>
<tr>
<th>SL</th>
<th>Date</th>
<th>Name</th>
<th>Designation</th>
<th>Emp ID</th>
<th>Division / Area / Territory</th>
<th>Distributor Name</th>
<th>Monthly Tour Plan</th>
<th>Today's Tour Plan</th>
<th>Tour With SO</th>
<th>SO Mobile</th>
<th>Visited Route</th>
<th>Outlet of Route</th>
<th>Office In Time</th>
<th>Remarks</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
let sl = 1;

function addData(){
    let text = document.getElementById("sms").value.trim();
    if(text===""){ alert("Paste SMS first"); return; }

    let row = `
    <tr>
        <td>${sl++}</td>
        <td contenteditable="true">${find(text,"Date")}</td>
        <td contenteditable="true">${find(text,"Name")}</td>
        <td contenteditable="true">${find(text,"Designation")}</td>
        <td contenteditable="true">${find(text,"EMP ID")}</td>
        <td contenteditable="true">
            ${find(text,"Division")} / ${find(text,"Area Name")}
        </td>
        <td contenteditable="true">${find(text,"Distributor")}</td>
        <td contenteditable="true">${find(text,"Monthly Tour Plan")}</td>
        <td contenteditable="true">${find(text,"Today Tour")}</td>
        <td contenteditable="true">${find(text,"Tour With SO")}</td>
        <td contenteditable="true">${find(text,"Mobile")}</td>
        <td contenteditable="true">${find(text,"Visited Route")}</td>
        <td contenteditable="true">${find(text,"Outlet of Route")}</td>
        <td contenteditable="true">${find(text,"Office in Time")}</td>
        <td contenteditable="true"></td>
    </tr>`;

    document.querySelector("#dataTable tbody")
        .insertAdjacentHTML("beforeend",row);

    document.getElementById("sms").value="";
}

function find(text,key){
    let r = new RegExp(key + "\\s*[:\\-]?\\s*(.*)","i");
    let m = text.match(r);
    return m ? m[1].trim() : "";
}

/* ===== EXPORT EXCEL ===== */
function exportExcel(){
    let csv="";
    document.querySelectorAll("#dataTable tr").forEach(tr=>{
        let row=[];
        tr.querySelectorAll("th,td").forEach(td=>{
            row.push(`"${td.innerText.replace(/"/g,'""')}"`);
        });
        csv+=row.join(",")+"\n";
    });

    let blob=new Blob([csv],{type:"text/csv"});
    let a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="Daily_Tour_Report.csv";
    a.click();
}
</script>

</body>
</html>
