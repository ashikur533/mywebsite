<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SMS Data Collector ‚Äì All in One</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f4f7;
}
.container{
    width:95%;
    margin:20px auto;
    background:#fff;
    padding:20px;
    box-shadow:0 0 10px #ccc;
}
textarea{
    width:100%;
    height:160px;
    padding:10px;
    font-size:14px;
}
button{
    padding:8px 15px;
    background:#0066cc;
    color:#fff;
    border:none;
    cursor:pointer;
    margin:5px 5px 5px 0;
}
button:hover{ background:#004999; }

.menu button{
    background:#333;
}
.menu button:hover{
    background:#000;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th,td{
    border:1px solid #aaa;
    padding:6px;
    font-size:13px;
}
th{ background:#e9eef3; }
td[contenteditable]{ background:#fffbe6; }

.section{ display:none; }
</style>
</head>

<body>

<div class="container">
<h2>üì© SMS Data Collector (All-in-One)</h2>

<div class="menu">
<button onclick="show('blank')">Blank Route SMS</button>
<button onclick="show('tour')">Daily Tour SMS</button>
<button onclick="show('manual')">Manual Headline</button>
</div>

<!-- ================= BLANK ROUTE ================= -->
<div id="blank" class="section">
<h3>Blank Route SMS</h3>
<textarea id="blank_sms" placeholder="Paste Blank Route SMS..."></textarea><br>

<button onclick="addBlank()">‚ûï Add</button>
<button onclick="exportTable('blankTable','Blank_Route_Report.csv')">üìä Export</button>

<table id="blankTable">
<thead>
<tr>
<th>SL</th><th>Division</th><th>Area</th><th>Territory</th>
<th>DB</th><th>Route</th><th>Status</th><th>Coverage By</th><th>Designation</th><th>Remarks</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- ================= DAILY TOUR ================= -->
<div id="tour" class="section">
<h3>Daily Tour SMS</h3>
<textarea id="tour_sms" placeholder="Paste Daily Tour SMS..."></textarea><br>

<button onclick="addTour()">‚ûï Add</button>
<button onclick="exportTable('tourTable','Daily_Tour_Report.csv')">üìä Export</button>

<table id="tourTable">
<thead>
<tr>
<th>SL</th><th>Date</th><th>Name</th><th>Designation</th><th>Emp ID</th>
<th>Division / Area</th><th>Distributor</th><th>Monthly Plan</th>
<th>Today Plan</th><th>Tour With</th><th>Mobile</th>
<th>Visited Route</th><th>Outlet</th><th>Office Time</th><th>Remarks</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- ================= MANUAL ================= -->
<div id="manual" class="section">
<h3>Manual Headline (Custom)</h3>

<b>‚úçÔ∏è Write Headline (one per line)</b>
<textarea id="manual_head">
Date
Name
Designation
Area
Remarks
</textarea>

<b>üì© Paste SMS</b>
<textarea id="manual_sms"></textarea><br>

<button onclick="addManual()">‚ûï Add</button>
<button onclick="exportTable('manualTable','Manual_Report.csv')">üìä Export</button>

<table id="manualTable">
<thead><tr id="manualHeadRow"><th>SL</th></tr></thead>
<tbody></tbody>
</table>
</div>

</div>

<script>
let sl1=1, sl2=1, sl3=1;

/* SHOW SECTION */
function show(id){
    document.querySelectorAll('.section').forEach(s=>s.style.display='none');
    document.getElementById(id).style.display='block';
}

/* FIND VALUE */
function find(text,key){
    let r=new RegExp(key+"\\s*[:\\-]?\\s*(.*)","i");
    let m=text.match(r);
    return m?m[1].trim():"";
}

/* BLANK ROUTE */
function addBlank(){
    let t=document.getElementById("blank_sms").value;
    let blocks=t.split(/Blank Route\s*\d+/i).slice(1);
    blocks.forEach(b=>{
        let r=`<tr>
        <td>${sl1++}</td>
        <td contenteditable>${find(t,"Division")}</td>
        <td contenteditable>${find(b,"Area")}</td>
        <td contenteditable>${find(b,"Territory")}</td>
        <td contenteditable>${find(b,"DB")}</td>
        <td contenteditable>${find(b,"Route")}</td>
        <td contenteditable>${find(b,"Status")}</td>
        <td contenteditable>${find(b,"Name")}</td>
        <td contenteditable>${find(b,"Designation")}</td>
        <td contenteditable></td></tr>`;
        blankTable.querySelector("tbody").insertAdjacentHTML("beforeend",r);
    });
    blank_sms.value="";
}

/* DAILY TOUR */
function addTour(){
    let t=tour_sms.value;
    let r=`<tr>
    <td>${sl2++}</td>
    <td contenteditable>${find(t,"Date")}</td>
    <td contenteditable>${find(t,"Name")}</td>
    <td contenteditable>${find(t,"Designation")}</td>
    <td contenteditable>${find(t,"EMP ID")}</td>
    <td contenteditable>${find(t,"Division")} / ${find(t,"Area")}</td>
    <td contenteditable>${find(t,"Distributor")}</td>
    <td contenteditable>${find(t,"Monthly")}</td>
    <td contenteditable>${find(t,"Today")}</td>
    <td contenteditable>${find(t,"Tour")}</td>
    <td contenteditable>${find(t,"Mobile")}</td>
    <td contenteditable>${find(t,"Visited")}</td>
    <td contenteditable>${find(t,"Outlet")}</td>
    <td contenteditable>${find(t,"Office")}</td>
    <td contenteditable></td></tr>`;
    tourTable.querySelector("tbody").insertAdjacentHTML("beforeend",r);
    tour_sms.value="";
}

/* MANUAL */
function addManual(){
    let heads=manual_head.value.split("\n").filter(h=>h);
    let sms=manual_sms.value;
    let headRow=document.getElementById("manualHeadRow");
    headRow.innerHTML="<th>SL</th>";
    heads.forEach(h=>headRow.innerHTML+=`<th>${h}</th>`);

    let row=`<tr><td>${sl3++}</td>`;
    heads.forEach(h=>row+=`<td contenteditable>${find(sms,h)}</td>`);
    row+="</tr>";
    manualTable.querySelector("tbody").insertAdjacentHTML("beforeend",row);
    manual_sms.value="";
}

/* EXPORT */
function exportTable(id,file){
    let csv="";
    document.querySelectorAll("#"+id+" tr").forEach(tr=>{
        let r=[];
        tr.querySelectorAll("th,td").forEach(td=>{
            r.push(`"${td.innerText.replace(/"/g,'""')}"`);
        });
        csv+=r.join(",")+"\n";
    });
    let a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([csv]));
    a.download=file;
    a.click();
}
</script>

</body>
</html>
